WITH Budgett AS 
(select Newf4,Months,sum(CompanyCurrency_HSL)as Budget from glpcp where TABFLAG='Budget' and Newf2='CITY & BUREAU EXP' and MONTHS='Apr' and  FiscalYear_RYEAR=(select Max(FiscalYear_RYEAR) from GLPCP ) group by NEWF4,Months),
Actualt  as(
select Newf4,Months,sum(CompanyCurrency_HSL)  as Actual from glpcp where TABFLAG='Actual' and Newf2='CITY & BUREAU EXP' and MONTHS='Apr' and  FiscalYear_RYEAR=(select Max(FiscalYear_RYEAR) from GLPCP ) group by NEWF4,Months),
Variancet as(
select Newf4,Months,sum(CompanyCurrency_HSL) as Variance1 from glpcp where (Origin_RHOART='03' or ORIGIN_RHOART='05') and Newf2='CITY & BUREAU EXP' and MONTHS='Apr' and  FiscalYear_RYEAR=(select Max(FiscalYear_RYEAR) from GLPCP )  group by NEWF4,Months)

select Budgett.Newf4,
Budgett.MONTHS,
nvl(Budgett.Budget,0) as Budget,
nvl(Actualt.Actual,0) as Actual,
Round((nvl(Budgett.Budget,0)- nvl(Actualt.Actual,0)),0) - NVL(Variancet.Variance1,0) as varianceval
from Budgett left join Actualt ON
Budgett.NEWF4=Actualt.NEWF4 
left join Actualt on
Budgett.NEWF4=Actualt.NEWF4 
left join Variancet on
Budgett.NEWF4=Variancet.NEWF4 
