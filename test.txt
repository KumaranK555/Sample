  public DataTable GroupingTrendOpex(DataTable dtmain)
        {

            DataTable tablenewf4 = new DataTable();
            tablenewf4.Columns.Add("HEAD", typeof(string));
            tablenewf4.Columns.Add("MONTHS", typeof(string));
            tablenewf4.Columns.Add("BUDGET", typeof(string));
            tablenewf4.Columns.Add("ACTUAL", typeof(string));
            tablenewf4.Columns.Add("JOBWORK", typeof(string));
            tablenewf4.Columns.Add("ADJUSTEDACTUAL", typeof(string));
            tablenewf4.Columns.Add("VARIANCE", typeof(string));
            tablenewf4.Columns.Add("GROUP", typeof(string));

            //string[] selectedColumns = new[] { "NEWF2" };
            //DataTable dt = new DataView(dtmain).ToTable(false, selectedColumns);

            int finaltotal = 0;
            for (int i = 0; i < dtmain.Rows.Count; i++)
            {

                string title = dtmain.Rows[i]["NEWF2"].ToString();
                bool exists = tablenewf4.AsEnumerable().Where(c => c.Field<string>("Head").Equals(title)).Count() > 0;
                if (exists == false)
                {

                    increment = 0;
                    tablenewf4.Rows.Add(dtmain.Rows[i]["NEWF2"].ToString(), dtmain.Rows[i]["MONTHS"].ToString(), dtmain.Rows[i]["BUDGET"].ToString(), dtmain.Rows[i]["ACTUAL"].ToString(), dtmain.Rows[i]["JOBWORK"].ToString(), dtmain.Rows[i]["ADJUSTEDACTUAL"].ToString(), dtmain.Rows[i]["VARIANCE"].ToString(), "NEWF2");
                    int total = 0;
                    // finaltotal = finaltotal + Convert.ToDecimal(dtmain.Rows[i]["Budget"].ToString());
                    var items = dtmain.Select("NEWF2 = '" + title + "'").Distinct().ToList();

                    for (int j = 0; j < items.Count(); j++)
                    {

                        string title1 = items[j]["NEWF3"].ToString();
                        bool exists1 = tablenewf4.AsEnumerable().Where(c => c.Field<string>("Head").Equals(title1)).Count() > 0;
                        if (exists1 == false)
                        {
                            tablenewf4.Rows.Add(items[j]["NEWF3"].ToString(), items[j]["MONTHS"].ToString(), items[j]["BUDGET"].ToString(), items[j]["ACTUAL"].ToString(), items[j]["JOBWORK"].ToString(), items[j]["ADJUSTEDACTUAL"].ToString(), items[j]["VARIANCE"].ToString(), "NEWF3");
                           
                            var items1 = dtmain.Select("Newf2 = '" + title + "' and Newf3 ='" + title1 + "'");
                            for (int k = 0; k < items1.Count(); k++)
                            {
                                tablenewf4.Rows.Add(items1[k]["NEWF4"].ToString(), items1[k]["MONTHS"].ToString(), items1[k]["BUDGET"].ToString(), items1[k]["ACTUAL"].ToString(), items1[k]["JOBWORK"].ToString(), items1[k]["ADJUSTEDACTUAL"].ToString(), items1[k]["VARIANCE"].ToString(), "NEWF4");
                               // total = total + Convert.ToInt32(items1[k]["TOTAL"].ToString());
                                
                            }

                            //DataRow dr1 = tablenewf4.Select("Head = '" + title1 + "'").FirstOrDefault(); // finds all rows with id==2 and selects first or null if haven't found any
                            //if (dr1 != null)
                            //{
                            //    dr1["TOTAL"] = total; //changes the Product_name                                 
                            //    finaltotal = finaltotal + total;
                            //    total = 0;

                            //}
                        }
                        else
                        {

                            if (title == title1 && increment == 0)
                            {
                                var items1 = dtmain.Select("NEWF2 = '" + title + "' and NEWF3 ='" + title1 + "'");
                                for (int k = 0; k < items1.Count(); k++)
                                {
                                   
                                    tablenewf4.Rows.Add(items1[k]["NEWF4"].ToString(), items1[k]["MONTHS"].ToString(), items1[k]["BUDGET"].ToString(), items1[k]["ACTUAL"].ToString(), items1[k]["JOBWORK"].ToString(), items1[k]["ADJUSTEDACTUAL"].ToString(), items1[k]["VARIANCE"].ToString(), "NEWF4");
                                   // total = total + Convert.ToInt32(items1[k]["TOTAL"].ToString());
                                    
                                }

                                //DataRow dr1 = tablenewf4.Select("Head = '" + title1 + "'").FirstOrDefault(); // finds all rows with id==2 and selects first or null if haven't found any
                                //if (dr1 != null)
                                //{
                                //    dr1["TOTAL"] = total; //changes the Product_name                                        
                                //    finaltotal = finaltotal + total;
                                //    total = 0;

                                //}
                                //increment++;
                            }
                        }
                    }

                    //DataRow dr = tablenewf4.Select("Head = '" + title + "'").FirstOrDefault(); // finds all rows with id==2 and selects first or null if haven't found any
                    //if (dr != null)
                    //{
                    //    dr["TOTAL"] = finaltotal; //changes the Product_name
                    //    finaltotal = 0;
                    //}
                }
            }
            return tablenewf4;
        }




  <asp:GridView ID="gvParentTrend" runat="server" AutoGenerateColumns="false" CssClass="Grid"
                            OnRowDataBound="gvParentTrend_RowDataBound" DataKeyNames="Head">
                            <Columns>
                               <asp:BoundField ItemStyle-Width="450px" DataField="HEAD" HeaderText="HEAD" />
                              <asp:BoundField ItemStyle-Width="450px" DataField="BUDGET" HeaderText="BUDGET" />
                                <asp:BoundField ItemStyle-Width="100px" DataField="ACTUAL" HeaderText="ACTUAL" />
                                <asp:BoundField ItemStyle-Width="100px" DataField="JOBWORK" HeaderText="JOBWORK" />
                                <asp:BoundField ItemStyle-Width="100px" DataField="ADJUSTEDACTUAL" HeaderText="ADJUSTEDACTUAL"  />
                                 <asp:BoundField ItemStyle-Width="100px" DataField="VARIANCE" HeaderText="VARIANCE"  />
                                  <asp:BoundField ItemStyle-Width="100px" DataField="Group" HeaderText="Group" HeaderStyle-CssClass="hidecol"
                                    ItemStyle-CssClass="hidecol" />
                            </Columns>
                            </asp:GridView>